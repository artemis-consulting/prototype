{% extends "core/base.html" %}

{% load staticfiles %}
{% load url_tags %}

{% block body %}

    <img src="{% static "images/drugs.png" %}" class="img-responsive center-block" alt="drug labels banner image">

    <div class="row">
        <div class="col-xs-12">
            <h3>Drug Details</h3>
            <p>Information for <strong>{{ q }}</strong></p>
        </div>
    </div>

<!-- Nav tabs -->
<div class="panel">
    <div class="panel-body">
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active"><a href="#labels" aria-controls="labels" role="tab" data-toggle="tab">Labels</a></li>
            <li role="presentation"><a href="#events" aria-controls="events" role="tab" data-toggle="tab">Adverse Events</a></li>
            <li role="presentation"><a href="#enforcements" aria-controls="enforcements" role="tab" data-toggle="tab">Enforcement Reports</a></li>
        </ul>

        <div class="tab-content">
            <!-- tab 1 -->
            <div role="tabpanel" class="tab-pane active" id="labels">
                <!-- accordion panel groups -->
                <div class="panel-group" aria-multiselectable="true">
                    {% for result in labels %}
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" href="#panel{{ forloop.counter }}" aria-expanded="false">
                                        {{ result.brand_name.0 }}  (id: {{ result.id }})
                                    </a>
                                </h4>
                            </div>
                            <div class="panel-collapse collapse" id="panel{{ forloop.counter }}">
                                <div class="panel-body">
                                    {% for key, value in result.items %}
                                        <div class="row">
                                            <div class="col-sm-3 col-xs-12">
                                                <strong>{{ key|replace_underscores }}</strong>
                                            </div>
                                            <div class="col-sm-9 col-xs-12 cell">
                                                <div class="text">
                                                  {% if value|is_list %}
                                                    {% for val in value %}
                                                      {{ val|default_if_none:"N/A" }}<br />
                                                    {% endfor %}
                                                  {% else %}
                                                    {{ value|default_if_none:"N/A" }}
                                                  {% endif %}
                                                </div>
                                                <span class="more">More...</span>
                                                <span class="less" style="display:none;">Less...</span>
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>

                    {% endfor %}
                </div>
            </div>

            <!-- tab 2 -->
            <div role="tabpanel" class="tab-pane" id="events">
                <!-- accordion panel groups -->
                <div class="panel-group" aria-multiselectable="true">

                {% for result in events %}
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                         <a role="button" data-toggle="collapse" href="#tab2_panel{{ forloop.counter }}" aria-expanded="false">
                           Safety Report Id: {{ result.safety_data.safety_report }} (received: {{ result.safety_data.receive_date }})
                         </a>
                      </h4>
                    </div>
                  </div>
                  <div class="panel-collapse collapse" id="tab2_panel{{ forloop.counter }}">
                    <div class="panel-body">
                      <table class="table table-striped table-bordered">
                        <caption>Reporting Sources</caption>
                        <tbody>
                          {% for key, value in result.safety_data.items %}
                          <tr>
                            <td>{{ key|replace_underscores }}</td>
                            <td>{% if value|is_list %}
                                  {% for val in value %}
                                    {{ val|default_if_none:"N/A" }}<br />
                                  {% endfor %}
                                {% else %}
                                  {{ value|default_if_none:"N/A" }}
                                {% endif %}
                            </td>
                          </tr>
                          {% endfor %}
                      </tbody>
                    </table>
                    <table class="table table-striped table-bordered">
                      <caption>
                        Patient Data
                      </caption>
                      <tbody>
                          {% for key, value in result.patient_data.items %}
                          <tr>
                            <td>{{ key|replace_underscores }}</td>
                            <td>{% if value|is_list %}
                                  {% for val in value %}
                                    {{ val|default_if_none:"N/A" }}<br />
                                  {% endfor %}
                                {% else %}
                                  {{ value|default_if_none:"N/A" }}
                                {% endif %}
                            </td>
                          </tr>
                          {% endfor %}
                      </tbody>
                    </table>
                    <table class="table table-striped table-bordered">
                      <caption>
                        Drug Data
                      </caption>
                      <tbody>
                          {% for key, value in result.label_data.items %}
                          <tr>
                            <td>{{ key|replace_underscores }}</td>
                            <td>{% if value|is_list %}
                                  {% for val in value %}
                                    {{ val|default_if_none:"N/A" }}<br />
                                  {% endfor %}
                                {% else %}
                                  {{ value|default_if_none:"N/A" }}
                                {% endif %}
                            </td>
                          </tr>
                          {% endfor %}
                      </tbody>
                    </table>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>

            <!-- tab 3 -->
            <div role="tabpanel" class="tab-pane" id="enforcements">
                <!-- accordion panel groups -->
                <div class="panel-group" aria-multiselectable="true">

                {% for result in enforcements %}
                  <div class="panel panel-default">
                    <div class="panel-heading">
                      <h4 class="panel-title">
                         <a role="button" data-toggle="collapse" href="#tab3_panel{{ forloop.counter }}" aria-expanded="false">
                           Recall Number: {{ result.recall_number }} [{{ result.report_date }}: {{ result.city }}, {{ result.state }}]
                         </a>
                      </h4>
                    </div>
                  </div>
                  <div class="panel-collapse collapse" id="tab3_panel{{ forloop.counter }}">
                    <div class="panel-body">
                      <table class="table table-striped table-bordered">
                        <tbody>
                        {% for key, value in result.items %}
                          <tr>
                             <td>{{ key|replace_underscores }}</td>
                             <td class="cell">
                               <div class="text">
                                  {% if value|is_list %}
                                    {% for val in value %}
                                      {{ val|default_if_none:"N/A" }}<br />
                                    {% endfor %}
                                  {% else %}
                                    {{ value|default_if_none:"N/A" }}
                                  {% endif %}
                               </div>
                               <span class="more">More...</span>
                               <span class="less" style="display:none;">Less...</span>
                             </td>
                           </tr>
                         {% endfor %}
                         </tbody>
                      </table>
                    </div>
                  </div>
                {% endfor %}
                </div>
              </div>
            </div>
        </div>

    </div>
</div>

{% endblock %}

{% block extra_js %}
{% endblock %}

